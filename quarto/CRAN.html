<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CRAN</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="CRAN_files/libs/clipboard/clipboard.min.js"></script>
<script src="CRAN_files/libs/quarto-html/quarto.js"></script>
<script src="CRAN_files/libs/quarto-html/popper.min.js"></script>
<script src="CRAN_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="CRAN_files/libs/quarto-html/anchor.min.js"></script>
<link href="CRAN_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="CRAN_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="CRAN_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="CRAN_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="CRAN_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#zeta-model" id="toc-zeta-model" class="nav-link active" data-scroll-target="#zeta-model">Zeta Model</a>
  <ul>
  <li><a href="#plots-of-zeta-model-fit" id="toc-plots-of-zeta-model-fit" class="nav-link" data-scroll-target="#plots-of-zeta-model-fit">Plots of Zeta Model Fit</a>
  <ul>
  <li><a href="#depends-data" id="toc-depends-data" class="nav-link" data-scroll-target="#depends-data">Depends Data</a></li>
  <li><a href="#imports-data" id="toc-imports-data" class="nav-link" data-scroll-target="#imports-data">Imports Data</a></li>
  <li><a href="#depends-data-without-zeros" id="toc-depends-data-without-zeros" class="nav-link" data-scroll-target="#depends-data-without-zeros">Depends Data (without zeros)</a></li>
  <li><a href="#imports-data-without-zeros" id="toc-imports-data-without-zeros" class="nav-link" data-scroll-target="#imports-data-without-zeros">Imports Data (without zeros)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#zeta-igpd-model" id="toc-zeta-igpd-model" class="nav-link" data-scroll-target="#zeta-igpd-model">Zeta-IGPD Model</a>
  <ul>
  <li><a href="#plots-of-fitted-model" id="toc-plots-of-fitted-model" class="nav-link" data-scroll-target="#plots-of-fitted-model">Plots of fitted model</a>
  <ul>
  <li><a href="#depends-data-1" id="toc-depends-data-1" class="nav-link" data-scroll-target="#depends-data-1">Depends data</a>
  <ul class="collapse">
  <li><a href="#quantile-0.95" id="toc-quantile-0.95" class="nav-link" data-scroll-target="#quantile-0.95">Quantile 0.95</a></li>
  <li><a href="#quantile-0.97" id="toc-quantile-0.97" class="nav-link" data-scroll-target="#quantile-0.97">Quantile 0.97</a></li>
  <li><a href="#quantile-0.98" id="toc-quantile-0.98" class="nav-link" data-scroll-target="#quantile-0.98">Quantile 0.98</a></li>
  <li><a href="#quantile-0.99" id="toc-quantile-0.99" class="nav-link" data-scroll-target="#quantile-0.99">Quantile 0.99</a></li>
  </ul></li>
  <li><a href="#imports-data-1" id="toc-imports-data-1" class="nav-link" data-scroll-target="#imports-data-1">Imports data</a>
  <ul class="collapse">
  <li><a href="#quantile-0.95-1" id="toc-quantile-0.95-1" class="nav-link" data-scroll-target="#quantile-0.95-1">Quantile 0.95</a></li>
  <li><a href="#quantile-0.97-1" id="toc-quantile-0.97-1" class="nav-link" data-scroll-target="#quantile-0.97-1">Quantile 0.97</a></li>
  <li><a href="#quantile-0.98-1" id="toc-quantile-0.98-1" class="nav-link" data-scroll-target="#quantile-0.98-1">Quantile 0.98</a></li>
  <li><a href="#quantile-0.99-1" id="toc-quantile-0.99-1" class="nav-link" data-scroll-target="#quantile-0.99-1">Quantile 0.99</a></li>
  </ul></li>
  <li><a href="#depends-without-zeros" id="toc-depends-without-zeros" class="nav-link" data-scroll-target="#depends-without-zeros">Depends Without Zeros</a>
  <ul class="collapse">
  <li><a href="#quantile-0.95-2" id="toc-quantile-0.95-2" class="nav-link" data-scroll-target="#quantile-0.95-2">Quantile 0.95</a></li>
  <li><a href="#quantile-0.97-2" id="toc-quantile-0.97-2" class="nav-link" data-scroll-target="#quantile-0.97-2">Quantile 0.97</a></li>
  <li><a href="#quantile-0.98-2" id="toc-quantile-0.98-2" class="nav-link" data-scroll-target="#quantile-0.98-2">Quantile 0.98</a></li>
  <li><a href="#quantile-0.99-2" id="toc-quantile-0.99-2" class="nav-link" data-scroll-target="#quantile-0.99-2">Quantile 0.99</a></li>
  </ul></li>
  <li><a href="#imports-without-zeros" id="toc-imports-without-zeros" class="nav-link" data-scroll-target="#imports-without-zeros">Imports Without Zeros</a>
  <ul class="collapse">
  <li><a href="#quantile-0.95-3" id="toc-quantile-0.95-3" class="nav-link" data-scroll-target="#quantile-0.95-3">Quantile 0.95</a></li>
  <li><a href="#quantile-0.97-3" id="toc-quantile-0.97-3" class="nav-link" data-scroll-target="#quantile-0.97-3">Quantile 0.97</a></li>
  <li><a href="#quantile-0.98-3" id="toc-quantile-0.98-3" class="nav-link" data-scroll-target="#quantile-0.98-3">Quantile 0.98</a></li>
  <li><a href="#quantile-0.99-3" id="toc-quantile-0.99-3" class="nav-link" data-scroll-target="#quantile-0.99-3">Quantile 0.99</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a>
  <ul>
  <li><a href="#implementation-of-zeta-function" id="toc-implementation-of-zeta-function" class="nav-link" data-scroll-target="#implementation-of-zeta-function">Implementation of zeta function</a>
  <ul>
  <li><a href="#defaults" id="toc-defaults" class="nav-link" data-scroll-target="#defaults">Defaults</a></li>
  <li><a href="#increasing-the-value-of-aa" id="toc-increasing-the-value-of-aa" class="nav-link" data-scroll-target="#increasing-the-value-of-aa">Increasing the value of aa</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">CRAN</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="zeta-model" class="level1">
<h1>Zeta Model</h1>
<p>We first consider modelling our data using the zeta model which is a power law model that has p.m.f:</p>
<p><span class="math display">\[
f(x) = \zeta(\alpha+1)^{-1}x^{-(\alpha+1)}, \qquad x=1,2,3,\ldots
\]</span></p>
<p>and has survival function:</p>
<p><span class="math display">\[
S(x) = 1-\zeta(\alpha+1)^{-1}\sum_{k=1}^x k^{-(\alpha+1)}, \qquad x=1,2,3,\ldots
\]</span></p>
<p>If we have a vector of data <span class="math inline">\(x = (x_1,x_2,\ldots,x_N)^T\)</span> , then the likelihood function and log-likelihood functions are:</p>
<p><span class="math display">\[
L(x) = \zeta(\alpha+1)^{-N}\prod_{i=1}^N x_i^{-(\alpha+1)}
\]</span></p>
<p>and,</p>
<p><span class="math display">\[
\ell(x) = -N\log\zeta(\alpha+1) - (\alpha+1)\sum_{i=1}^N\log x_i
\]</span></p>
<p>We now aim to fit this model using a Metropolis-Hastings algorithm, which means we need to put a prior on to the value of <span class="math inline">\(\alpha\)</span>. Since its value is restricted to being positive we choose to use a Gamma prior, that is:</p>
<p><span class="math display">\[
\alpha \sim Ga(\gamma,\delta)
\]</span></p>
<p>with the prior density function being:</p>
<p><span class="math display">\[
\pi(\alpha) \propto \alpha^{\gamma-1}e^{-\delta\alpha}
\]</span></p>
<p>Now, we can calculate the posterior distribution up to a constant of proportionality:</p>
<p><span class="math display">\[
\pi(\alpha|x) \propto\pi(\alpha)L(x)
\]</span></p>
<p>But, it will be better to use the log of the posterior distribution to mitigate any computational issues that may arise.</p>
<p><span class="math display">\[
\log\pi(\alpha|x) = \log A + (\gamma-1)\log\alpha-N\log\zeta(\alpha+1)-\delta\alpha-(\alpha+1)\sum_{i=1}^N\log x_i
\]</span></p>
<p>With this posterior we can fit the model to both sets of our data.</p>
<section id="plots-of-zeta-model-fit" class="level2">
<h2 class="anchored" data-anchor-id="plots-of-zeta-model-fit">Plots of Zeta Model Fit</h2>
<section id="depends-data" class="level3">
<h3 class="anchored" data-anchor-id="depends-data">Depends Data</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="imports-data" class="level3">
<h3 class="anchored" data-anchor-id="imports-data">Imports Data</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="depends-data-without-zeros" class="level3">
<h3 class="anchored" data-anchor-id="depends-data-without-zeros">Depends Data (without zeros)</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="imports-data-without-zeros" class="level3">
<h3 class="anchored" data-anchor-id="imports-data-without-zeros">Imports Data (without zeros)</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="zeta-igpd-model" class="level1">
<h1>Zeta-IGPD Model</h1>
<p>Since the zeta model seems to not fit very well, we now aim to fit a new model to the data that may fit better. This model model the data as before below a certain threshold but above it the data is modeled using the integer-valued generalised Pareto distribution. The p.m.f of this model is</p>
<p><span class="math display">\[
f(x) =
\begin{cases}
\zeta(\alpha+1)^{-1}x^{-(\alpha+1)}&amp;, x\leq u\\
\left[1-\zeta(\alpha+1)^{-1}\sum_{k=1}^u k^{-(\alpha+1)}\right]\left\{\left(1+\frac{\xi(x-1)}{\sigma_u}\right)_+^{-1/\xi} - \left(1+\frac{\xi x}{\sigma_u}\right)_+^{-1/\xi}\right\}&amp;,x&gt;u
\end{cases}
\]</span></p>
<p>And the cumulative mass function is given by:</p>
<p><span class="math display">\[
F(x) = \begin{cases}
\zeta(\alpha+1)^{-1}\sum_{k=1}^xk^{-(\alpha+1)}&amp;,x\leq u\\
\zeta(\alpha+1)^{-1}\sum_{k=1}^uk^{-(\alpha+1)} + \left[1-\zeta(\alpha+1)^{-1}\sum_{k=1}^u k^{-(\alpha+1)}\right]\sum_{k=u+1}^x\left\{\left(1+\frac{\xi(k-1)}{\sigma_u}\right)_+^{-1/\xi} - \left(1+\frac{\xi k}{\sigma_u}\right)_+^{-1/\xi}\right\}&amp;,x&gt;u
\end{cases}
\]</span></p>
<p>This can be simplified to:</p>
<p><span class="math display">\[
F(x) = \begin{cases}
\zeta(\alpha+1)^{-1}\sum_{k=1}^xk^{-(\alpha+1)}&amp;,x\leq u\\
\zeta(\alpha+1)^{-1}\sum_{k=1}^uk^{-(\alpha+1)} + \left[1-\zeta(\alpha+1)^{-1}\sum_{k=1}^u k^{-(\alpha+1)}\right]\left\{1 - \left(1+\frac{\xi k}{\sigma_u}\right)_+^{-1/\xi}\right\}&amp;,x&gt;u
\end{cases}
\]</span></p>
<p>Which makes the survival function of this model:</p>
<p><span class="math display">\[
S(x) =
\begin{cases}
1-\zeta(\alpha+1)^{-1}\sum_{k=1}^x k^{-(\alpha+1)}&amp;,x\leq u\\
\left[1-\zeta(\alpha+1)^{-1}\sum_{k=1}^u k^{-(\alpha+1)}\right]\left(1+\frac{\xi x}{\sigma_u}\right)_+^{-1/\xi}&amp;,x&gt;u
\end{cases}
\]</span></p>
<p>If we have a vector of data <span class="math inline">\(x = (x_1,x_2,\ldots x_N)^T\)</span> then the likelihood and log-likelihood are:</p>
<p><span class="math display">\[
L(x) = \zeta(\alpha+1)^{-n}C_{\alpha,u}^{N-n}\prod_{i:x_i\leq u}x_i^{-(\alpha+1)}\prod_{i:x_i&gt;u}\left\{\left(1+\frac{\xi(x_i-1)}{\sigma_u}\right)_+^{-1/\xi} - \left(1+\frac{\xi x_i}{\sigma_u}\right)_+^{-1/\xi}\right\}
\]</span></p>
<p>and,</p>
<p><span class="math display">\[
\ell(x) = -n\log\zeta(\alpha+1)+(N-n)\log C_{\alpha,u} -(\alpha+1)\sum_{i:x_i\leq u}\log x_i + \sum_{i:x_i&gt;u}\log\left\{\left(1+\frac{\xi(x_i-1)}{\sigma_u}\right)_+^{-1/\xi} - \left(1+\frac{\xi x_i}{\sigma_u}\right)_+^{-1/\xi}\right\}
\]</span></p>
<p>where <span class="math inline">\(C_{\alpha,u} = 1-\zeta(\alpha+1)^{-1}\sum_{k=1}^u k^{-(\alpha+1)}\)</span>.</p>
<p>Since we wish to use this to construct a Metropolis-Hastings algorithm we again need some priors for the values of the parameters. The priors we use are listed below.</p>
<p><span class="math display">\[
\alpha\sim Ga(\gamma,\delta),\\
\xi \sim N(0,s^2),\\
\sigma_u \sim Ga(\phi,\psi)
\]</span></p>
<p>Our joint prior distribution is defined as follows:</p>
<span class="math display">\[\begin{align}
\pi(\alpha,\xi,\sigma_u) &amp;= \pi(\alpha)\pi(\xi)\pi(\sigma_u)\\
\log\pi(\alpha,\xi\sigma_u) &amp;= \log\pi(\alpha) +\log\pi(\xi) +\log\pi(\sigma_u)
\end{align}\]</span>
<p>And we have that</p>
<span class="math display">\[\begin{align}
\log\pi(\alpha) &amp;= \gamma\log\delta - \log\Gamma(\gamma) + (\gamma-1)\log\alpha -\delta\alpha\\
\log\pi(\xi) &amp;= -\log s -0.5\log 2\pi - \frac{\xi^2}{2s^2}\\
\log\pi(\sigma_u) &amp;= \phi\log\psi - \log\Gamma(\phi) + (\phi-1)\log\sigma_u - \psi\sigma_u
\end{align}\]</span>
<p>Which we can then use to construct the joint posterior:</p>
<span class="math display">\[\begin{align}
\pi(\alpha,\xi,\sigma_u|x) &amp;\propto L(x)\pi(\alpha,\xi,\sigma_u)\\
                            &amp;=L(x)\pi(\alpha)\pi(\xi)\pi(\sigma_u)\\
\log\pi(\alpha,\xi,\sigma_u|x) &amp;= \log A + \ell(x) +  \log\pi(\alpha) +\log\pi(\xi) + \log\pi(\sigma_u)\\
&amp;= \log B - n\log\zeta(\alpha+1) - (\alpha + 1)\sum_{i:x_i\leq u}\log x_i + (N-n)\log C_{\alpha,u} + \sum_{i:x_i&gt;u}\log[G(x_i-1) - G(x_i)]\\

&amp;\qquad + (\gamma-1)\log\alpha - \delta\alpha -\frac{\xi^2}{2s^2} + (\phi-1)\log\sigma_u - \psi\sigma_u
\end{align}\]</span>
<p>We can now use this to fit the model for various thresholds, the thresholds we will be using will be based on the quantiles of our data.</p>
<section id="plots-of-fitted-model" class="level2">
<h2 class="anchored" data-anchor-id="plots-of-fitted-model">Plots of fitted model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>n.iter<span class="ot">=</span><span class="fl">1e4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="depends-data-1" class="level3">
<h3 class="anchored" data-anchor-id="depends-data-1">Depends data</h3>
<section id="quantile-0.95" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.95">Quantile 0.95</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.97" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.97">Quantile 0.97</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.98" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.98">Quantile 0.98</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.99" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.99">Quantile 0.99</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="imports-data-1" class="level3">
<h3 class="anchored" data-anchor-id="imports-data-1">Imports data</h3>
<section id="quantile-0.95-1" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.95-1">Quantile 0.95</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.97-1" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.97-1">Quantile 0.97</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.98-1" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.98-1">Quantile 0.98</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.99-1" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.99-1">Quantile 0.99</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="depends-without-zeros" class="level3">
<h3 class="anchored" data-anchor-id="depends-without-zeros">Depends Without Zeros</h3>
<section id="quantile-0.95-2" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.95-2">Quantile 0.95</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.97-2" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.97-2">Quantile 0.97</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.98-2" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.98-2">Quantile 0.98</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.99-2" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.99-2">Quantile 0.99</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="imports-without-zeros" class="level3">
<h3 class="anchored" data-anchor-id="imports-without-zeros">Imports Without Zeros</h3>
<section id="quantile-0.95-3" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.95-3">Quantile 0.95</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.97-3" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.97-3">Quantile 0.97</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.98-3" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.98-3">Quantile 0.98</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantile-0.99-3" class="level4">
<h4 class="anchored" data-anchor-id="quantile-0.99-3">Quantile 0.99</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="notes" class="level1">
<h1>Notes</h1>
<section id="implementation-of-zeta-function" class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-zeta-function">Implementation of zeta function</h2>
<p>Below is a plot demonstrating the difference in the values obtained from the two different implementations of the hurwitz zeta function.There appears to be a large difference, with the gsl library being more accurate, evidenced by the fact that we can increase the ‘aa’ variable in the function from VGAM and obtain values closer to those obtained from gsl.</p>
<section id="defaults" class="level3">
<h3 class="anchored" data-anchor-id="defaults">Defaults</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="increasing-the-value-of-aa" class="level3">
<h3 class="anchored" data-anchor-id="increasing-the-value-of-aa">Increasing the value of aa</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="CRAN_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>